{"version":3,"sources":["../src/vanilla-modal.js"],"names":["_","require","includes","ModalClass","config","init","defaults","closeClass","contentClass","overlayClass","sourceClass","toggleClass","_init","open","_render","_getSource","_getToggle","toggle","source","_createOverlay","close","addEventListener","_closeClick","bind","overlay","_overlayClick","_overlayTouch","_toggleClick","document","body","appendChild","delay","_setContentClass","_setOverlayClass","e","preventDefault","_setModalVisibility","span","createElement","innerHTML","className","setAttribute","_addCloseClickListener","content","_createClose","_addOverlayClickListener","_addOverlayTouchListener","_createContent","element","querySelector","_addToggleClickListener","images","querySelectorAll","forEach","image","dataSrc","getAttribute","src","isEmpty","target","touches","length","removeChild","replace","html","getElementsByTagName","_removeOverlay","_appendOverlay","_setHTMLClass","_setOpenState","_lazyLoadImages","module","exports"],"mappings":"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","file":"vanilla-modal.js","sourcesContent":["const _ = require('lodash/core');\n_.includes = require('lodash/includes');\n\nclass ModalClass{\n  constructor(config = {}, init = true){\n    this.config = _.defaults(config,\n      {closeClass: 'modal-close'\n      , contentClass: 'modal-content'\n      , overlayClass: 'modal-overlay'\n      , sourceClass: 'modal-source'\n      , toggleClass: 'modal-toggle'\n      }\n    );\n\n    if (init){\n      this._init();\n    }\n  }\n\n  _init(){\n    this.open = false;\n    this._render();\n  }\n\n  _render(){\n    this._getSource();\n    this._getToggle();\n\n    if (this.toggle && this.source){\n      this._createOverlay();\n    }\n  }\n\n  _addCloseClickListener(){\n    this.close.addEventListener('click', this._closeClick.bind(this), false);\n  }\n\n  _addOverlayClickListener(){\n    /* eslint-disable max-len */\n    this.overlay.addEventListener('click', this._overlayClick.bind(this), false);\n    /* eslint-enable */\n  }\n\n  _addOverlayTouchListener(){\n    /* eslint-disable max-len */\n    this.overlay.addEventListener('touchstart', this._overlayTouch.bind(this), false);\n    /* eslint-enable */\n  }\n\n  _addToggleClickListener(){\n    this.toggle.addEventListener('click', this._toggleClick.bind(this), false);\n  }\n\n  _appendOverlay(){\n    document.body.appendChild(this.overlay);\n\n    _.delay(()=>{\n      this._setContentClass();\n      this._setOverlayClass();\n    }, 100);\n  }\n\n  _closeClick(e){\n    e.preventDefault();\n\n    this._setModalVisibility();\n  }\n\n  _createClose(){\n    let span = document.createElement('span');\n    this.close = document.createElement('a');\n\n    span.innerHTML = 'close';\n\n    this.close.className = this.config.closeClass;\n    this.close.setAttribute('href', '#');\n    this.close.appendChild(span);\n\n    this._addCloseClickListener();\n\n    this.content.appendChild(this.close);\n  }\n\n  _createContent(){\n    this.content = document.createElement('div');\n\n    this.content.className = this.config.contentClass;\n\n    this.content.innerHTML = this.source.innerHTML;\n\n    this._createClose();\n\n    this.overlay.appendChild(this.content);\n  }\n\n  _createOverlay(){\n    this.overlay = document.createElement('div');\n\n    this.overlay.className = this.config.overlayClass;\n\n    this._addOverlayClickListener();\n    this._addOverlayTouchListener();\n\n    this._createContent();\n  }\n\n  _getSource(){\n    /* eslint-disable max-len */\n    this.source = this.config.element.querySelector('.' + this.config.sourceClass);\n    /* eslint-enable */\n  }\n\n  _getToggle(){\n    /* eslint-disable max-len */\n    this.toggle = this.config.element.querySelector('.' + this.config.toggleClass);\n    /* eslint-enable */\n\n    this._addToggleClickListener();\n  }\n\n  _lazyLoadImages(){\n    let images = this.content.querySelectorAll('img');\n\n    _.forEach(images, (image)=>{\n      let dataSrc = image.getAttribute('data-src');\n      let src = image.getAttribute('src');\n\n      if (dataSrc && _.isEmpty(src)){\n        image.src = dataSrc;\n      }\n    });\n  }\n\n  _overlayClick(e){\n    if (e.target === this.overlay && this.open){\n      e.preventDefault();\n\n      this._setModalVisibility();\n    }\n  }\n\n  _overlayTouch(e){\n    if (e.touches.length === 2){\n      e.preventDefault();\n    }\n  }\n\n  _removeOverlay(){\n    this._setOverlayClass();\n    this._setContentClass();\n\n    _.delay(()=>{\n      document.body.removeChild(this.overlay);\n    }, 500);\n  }\n\n  _setContentClass(){\n    let className = this.content.className;\n\n    if (_.includes(className, 'active')){\n      this.content.className = className.replace(/(?:^|\\s)active(?!\\S)/g, '');\n    } else {\n      this.content.className += ' active';\n    }\n  }\n\n  _setHTMLClass(){\n    let html = document.getElementsByTagName('html')[0];\n    let className = html.className;\n\n    if (_.includes(className, 'modal-open')){\n      html.className = className.replace(/(?:^|\\s)modal-open(?!\\S)/g, '');\n    } else {\n      html.className += ' modal-open';\n    }\n  }\n\n  _setModalVisibility(){\n    if (this.open){\n      this._removeOverlay();\n    } else {\n      this._appendOverlay();\n    }\n\n    this._setHTMLClass();\n    this._setOpenState();\n  }\n\n  _setOpenState(){\n    this.open = !this.open;\n  }\n\n  _setOverlayClass(){\n    let className = this.overlay.className;\n\n    if (_.includes(className, 'active')){\n      this.overlay.className = className.replace(/(?:^|\\s)active(?!\\S)/g, '');\n    } else {\n      this.overlay.className += ' active';\n    }\n  }\n\n  _toggleClick(e){\n    e.preventDefault();\n\n    this._lazyLoadImages();\n    this._setModalVisibility();\n  }\n}\n\nmodule.exports = ModalClass;\n"]}